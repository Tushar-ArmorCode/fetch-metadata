#!/bin/bash

# Make sure we notice any untracked files generated by the build in the dist/ directory
git add --intent-to-add .
git diff --quiet dist/
retVal=$?
if [ $retVal -ne 0 ]; then
  echo "Detected uncommitted changes after build:"
  # The contents of the diff/ folder are marked as generated:
  # https://github.com/dependabot/fetch-metadata/blob/6c2bf2fe33cc133b474165107a8b29ccc265dc96/.gitattributes#L1
  # so this ensures we spit out the actual change in the obfuscated JS.
  git --no-pager diff dist/
  exit 1
fi
